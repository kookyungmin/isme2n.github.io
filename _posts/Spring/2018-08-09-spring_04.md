---

layout: post

title:  "[Spring] 4.MyBatis설정"

subtitle: "[Spring] 4.MyBatis설정"

date:   2018-08-09 09:00:20 -0500

categories: Server

tags: spring

---

<br>
<br>

## MyBatis 구성

<br>
<br>


## MtBatis 연동을 위한 준비

<br>
<br>
MyBatis 연동을 위해 준비해야할 것들이 많습니다!
<br>
<br>
차례로 따라해주시면 됩니다!
<br>
<br>
<br>

## spring-jdbc, spring-test, MyBatis, mybatis-spring 추가

<br>
<br>
pom.xml에 다음 문장을 추가해서 maven을 통해 다운을 받겠습니다.
<br>
<br>
<br>

```xml
<!-- MyBatis -->
<dependency>
	<groupId>org.mybatis</groupId>				
    <artifactId>mybatis</artifactId>
	<version>3.4.1</version>
</dependency>
		
<!-- MyBatis-Spring -->
	<dependency>
	<groupId>org.mybatis</groupId>
	<artifactId>mybatis-spring</artifactId>
	<version>1.3.0</version>
</dependency>
		
<!-- spring-jdbc -->
<dependency>
	<groupId>org.springframework</groupId>
	<artifactId>spring-jdbc</artifactId>
	<version>${org.springframework-version}</version>
</dependency>

<!-- spring-test -->
<dependency>
	<groupId>org.springframework</groupId>
	<artifactId>spring-test</artifactId>
	<version>${org.springframework-version}</version>
</dependency>
```

<br>
<br>
아래와 같이 pom.xml의 Dependencies 목록을 이용하면 더 쉽게 추가할 수 있습니다.
<br>
<br>
<br>

![image](/image/Spring_image/Spring_image_30.png)

<br>
<br>
<br>

![image](/image/Spring_image/Spring_image_31.png)

<br>
<br>
<br>
maven이 잘 다운받았네요!
<br>
<br>
<br>

## Spring Project에서 root-context.xml 파일 추가 및 수정

<br>
<br>
src/main/webapp/WEB-INF/spring/root-context.xml 파일은 STS가 스프링 프로젝트를 생성할 때 만들어 주는 가장 중요한 파일입니다~!
<br>
<br>
<br>
다음과 같이 추가해줍니다~
<br>
<br>
<br>

![image](/image/Spring_image/Spring_image_32.png)

<br>
<br>
<br>
그럼 root-context.xml이 추가되었습니다!
<br>
<br>
<br>

![image](/image/Spring_image/Spring_image_33.png)

<br>
<br>
<br>
이 파일은 스프링과 관련된 설정을 할 때, 쉽게 말해  jsp와 관련이 없는 객체(bean)를 설정해주는 비즈니스 로직을 위한 설정입니다.
<br>
<br>
반면에, appServlet 폴더 내에 있는 servlet-context.xml 파일이 jsp와 관련 있는 객체(bean)를 설정해줍니다. 
(controller, MultipartResolver(파일 업로드), Interceptor(로그인) 등)
<br>
<br>
root-context.xml 파일에서 스프링 프레임워크에 다양한 설정을 하기 위해서는 STS 상에서 Namespaces 탭을 이용해 사용 가능한 XML 태그의 폭을 넓혀 줘야합니다.
<br>
<br>
<br>

![image](/image/Spring_image/Spring_image_34.png)

<br>
<br>
<br>

## MySQL과의 연결을 담당하는 DataSource 설정하기

<br>
<br>
DataSource는 JDBC의 커넥션을 처리하는 기능을 가지고 있기 때문에 데이터베이스와의 연동 작업에 반드시 필요합니다!
<br>
<br>
<br>
전 장에서 JDBC만을 이용했을 때 연동하는 코드 기억하시나요?
<br>
<br>
<br>

```java
public class MYSQLConnectionTest {
	private static final String DRIVER = "com.mysql.jdbc.Driver"; // Connection을 구현한 클래스의 이름
	private static final String URL = "jdbc:mysql://35.200.109.72:3306/testdb?useSSL=false"; // mysql 서버 주소
	private static final String USER = "root"; // 계정
	private static final String PW = "비~밀"; // 비밀번호

	@Test // jUnit이 테스트함
	public void testConnection() throws Exception {
		Class.forName(DRIVER); // DRIVER라는 이름을 가진 클래스를 찾음

		try (Connection con = DriverManager.getConnection(URL, USER, PW)) { 
			System.out.println(con);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}
```

<br>
<br>
DataSource를 이용하면 좀 더 간단하게 DB에 접근할 수 있습니다!
<br>
<br>
<br>
먼저, root-context.xml에 다음을 추가합니다!
<br>
<br>
<br>

```xml
<!-- dataSource 설정, spring-jdbc 모듈 사용, spring 에서 jdbc 를 통해 mysql 에 접속할 수 있게 함 -->
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
	
    <property name="driverClassName" value="com.mysql.jdbc.Driver"></property> 
    <property name="url" value="jdbc:mysql://35.200.109.72:3306/testdb?useSSL=false"></property>
    <property name="kookyungmin" value="zerock"></property>
    <property name="비~밀" value="zerock"></property>
</bean>
```